---
title: "Chapter 3 Applied Exercises"
author: "Caitlyn Ralph"
date: "2/19/2018"
output_dir: "."
output: 
  html_document:
    toc: true
    toc_depth: 5
    toc_float: true
    number_sections: false
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question 8: Simple Linear Regression on the `Auto` dataset

1. 

```{r}
library(ISLR)
attach(Auto)
lm.auto = lm(mpg~horsepower)
summary(lm.auto)
```

According to the p-value (< 2.2e-16), there seems to be a relationship between `mpg` and `horsepower`. Looking at the R^2^ value (0.6049), the strength of the relationship appears to be average and positive.

```{r}
predict(lm.auto,data.frame(horsepower=98), interval="confidence")
predict(lm.auto,data.frame(horsepower=98), interval="prediction")
```

2. 

```{r}
plot(horsepower,mpg)
abline(lm.auto,lwd=3,col="red")
```

3. 

```{r}
par(mfrow=c(2,2))
plot(lm.auto)
```

There is some evidence of non-linearity.

## Question 9: Multiple Linear Regression

1. 

```{r}
pairs(Auto)
```

2. 

```{r}
cor(subset(Auto, select=-name))
```

3. 

```{r}
lm.fit=lm(mpg~.-name,data=Auto)
summary(lm.fit)
```

According to the p-value (< 2.2e-16), there seems to be a relationship between `mpg` and the other variables. It seems displacement, weight, year, and origin have relationships with `mpg`. The year variable, in particular, suggests that the older the year, the lower the mpg. As year increases, mpg increases.

4. 

```{r}
par(mfrow=c(2,2))
plot(lm.fit)
```

There seem to be some outliers because the residual plot has a curve to it. The leverage plot does identify a point that has unusually high leverage, point 14.

5. 

By using the correlation matrix, I pulled out displacement + weight (` 0.9329944`) and cyliners + displacement (`0.9508233`) as the highest correlated variables. I used them for the interaction effects with mpg:

```{r}
summary(lm(mpg~displacement*weight+cylinders*displacement,data=Auto))
```

According to the resulting p-values, displacement and weight have an interaction effect, but displacement and cylinders do not.

6. 

Log of `mpg` and `horsepower`

```{r}
summary(lm(mpg~log(horsepower),data=Auto))
```

Sqrt of `mpg` and `horsepower`

```{r}
summary(lm(mpg~sqrt(horsepower),data=Auto))
```

Sqaured of `mpg` and `horsepower`

```{r}
summary(lm(mpg~I(horsepower^2),data=Auto))
```

Looking at the R^2^ statistic, the strongest relationship occurred with the log transformation.

## Question 10: `Carseats` dataset

1. 

```{r}
library(ISLR)
attach(Carseats)
lm.car=lm(Sales~Price+Urban+US,data=Carseats)
summary(lm.car)
```

2. 

Looking at the coefficients' p-values, it appears `Price` has a relationship with `Sales`. When `Price` is lower, `Sales` increases. It also appears `US` has a relationship with `Sales`. When the carseat is from the US, it looks like `Sales` increase.

3. 

`Sales` = $\beta$~0~ + $\beta$~1~`Price` + $\beta$~2~`Urban` + $\beta$~3~`US` + $\epsilon$

4. 

We can reject the null hypothesis for `Price` and `US`.

5. 

```{r}
lm.car2=lm(Sales~Price+US,data=Carseats)
summary(lm.car2)
```

6. 

Looking at the ressidual standard error, it seems the second model only using `Price` and `US` fits the data slightly better.

7. 

```{r}
confint(lm.car2)
```

8. 

```{r}
par(mfrow=c(2,2))
plot(lm.car2)
```

Looking at the residual plot, there seems to be evidence of linearity, which means a least squares fit could be effective. The leverage plot identified point 368 as a high leverage point.